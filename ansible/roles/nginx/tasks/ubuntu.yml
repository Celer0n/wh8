- name: Installing nginx
  ansible.builtin.apt:
    name: nginx
    state: fixed
    update_cache: yes
    autoremove: yes

- name: Delete /var/www/html
  ansible.builtin.file:
    path: "/var/www/html"
    state: "absent"

- name: Copy default index.html
  ansible.builtin.copy:
    src: "./files/html/"
    dest: "/var/www/html/"
    mode: "0644"

- name: Replace nginx configuration
  ansible.builtin.template:
    src: "./templates/default.conf.j2"
    dest: "/etc/nginx/sites-available/default.conf"
    mode: "0644"

- name: restart nginx
  service:
    name: nginx
    state: restarted
